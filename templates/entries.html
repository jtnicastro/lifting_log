<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Lifting Log | Entries</title>
        <!-- Bootstrap core CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Custom styles for this template -->
        <link href="{{ url_for('static', filename='theme.css') }}" rel="stylesheet">
    </head>
    
    <body class="bg-dark">
        <div class="container p-5 text-white text-center">
             <h1>Lifting Log</h1>

            <p class="h6">Keep track of your workout regiment</p>
        </div>
        
        <!-- Navigation bar -->
        <nav class="navbar navbar-expand-sm bg-secondary navbar-dark">
            <div class="container-fluid"> 
              <span class="navbar-brand"><b>Lifting Log</b> .....<small> Hello <i>{{ current_user.username }}</i></small></span>

                <ul class="navbar-nav">
                    <li class="nav-item"> <a class="nav-link active" href="{{ url_for('entries') }}">Entries</a>

                    </li>
                    <li class="nav-item"> <a class="nav-link" href="{{ url_for('addExercise') }}">Add Workout</a>

                    </li>
                    <li class="nav-item"> <a class="nav-link" href="{{ url_for('analyze') }}">Analyze</a>

                    </li>
                    <li class="nav-item"> <a class="nav-link" href="{{ url_for('logout') }}">Sign Out</a>

                    </li>
                </ul>
            </div>
        </nav>

        <div class="small-middle-container text-white pt-5">
            <h2> Add Entry </h2> 
              <form method = "POST" action="{{ url_for('entries') }}">
                <div class="form-floating">
                    <select class="form-select form-select-lg" id="workout" name="workoutSelect">
                      {% for workout in workouts %}
                        <option value={{ workout.workout_id }}>{{ workout.workout_name }}</option>
                      {% endfor %}
                    </select>
                    <label for="workout" class="form-label">Select workout:</label>
                </div>
                <button type="submit" class="btn btn-danger btn-lg mt-3 mb-3">Select</button>
              </form>  
        </div>
        <div class="small-middle-container pt-4 pb-4">
          {% for log in card_log %}
            <div class="card bg-light text-dark text-center mt-5">
                <div class="card-header">
                     <h5>{{ log.workout.workout_name }}</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">Exercise</th>
                                    <th scope="col">Sets</th>
                                    <th scope="col">Weight (lbs.)</th>
                                    <th scope="col">Reps</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for detail in log.log_details %}
                                <tr>
                                    <th scope="row">{{ detail.exercise.exercise_name }}</th>
                                    <td>{{ detail.sets }}</td>
                                    <td>{{ detail.weight }}</td>
                                    <td>{{ detail.repetitions }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer text-muted">{{ log.log_date.strftime("%m/%d/%Y") }}</div>
            </div>
          {% endfor %}
        </div>

        {% if selected_workout %}
        <!-- Modal header -->
        <div class="modal show" id="Select" style="display: block;" aria-modal="true">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">{{ selected_workout.workout_name }}</h4>
                        <a href="{{ url_for('entries') }}" class="btn-close"></a>
                    </div>
                    <!-- Modal body -->
                    <form method="POST" action="{{ url_for('log_Workout') }}">
                      {{ form.csrf_token }}
                      <div class="modal-body">
                              {% for exercise, exercise_detail in zip(selected_workout.exercises, form.exercises) %}
                              <div class="row pt-2">
                                  <div class="col-3 pt-2">
                                      <p>{{ exercise.exercise_name }}:</p>
                                      <input type="hidden" name="workoutSelect" value="{{ selected_workout.workout_id }}">
                                      {{ exercise_detail.exercise_id(class="form-control", type="hidden", value=exercise.exercise_id) }}
                                  </div>
                                  <label for="sets{{ loop.index }}" class="col-1 col-form-label m-0">Sets</label>
                                  <div class="col-1 p-0">
                                      {{ exercise_detail.sets(id="sets" ~ loop.index, class="form-control") }}
                                  </div>
                                  <label for="weight{{ loop.index }}" class="col-1 col-form-label ms-5 me-1 m-0">Weight</label>
                                  <div class="col-1 p-0">
                                      {{ exercise_detail.weight(id="weight" ~ loop.index, class="form-control") }}
                                  </div>
                                  <label for="weight{{ loop.index }}" class="col-1 col-form-label me-1">Lbs.</label>
                                  <label for="reps{{ loop.index }}" class="col-1 col-form-label m-0">Reps</label>
                                  <div class="col-1 p-0">
                                      {{ exercise_detail.reps(id="reps" ~ loop.index, class="form-control") }}
                                  </div>
                              </div>
                              {% endfor %}
                      </div>
                      <!-- Modal footer -->
                      <div class="modal-footer">
                          <!--
                          <a href="{{ url_for('entries') }}" class="btn btn-danger" role="submit">Add</a>
                        -->
                          <button type="submit" class="btn btn-danger">Add</button>
                      </div>
                  </form>
                </div>
            </div>
        </div>
        {% endif %}
    </body>
</html>